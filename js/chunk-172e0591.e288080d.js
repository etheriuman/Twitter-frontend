(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-172e0591"],{"1c9f":function(t,e,r){},2957:function(t,e,r){"use strict";var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"list-group-item"},[r("div",{staticClass:"main-content"},[r("div",{staticClass:"main-left"},[r("router-link",{attrs:{to:{name:"user-tweets",params:{id:t.follow.id}}}},[r("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.follow.avatar),alt:"avatar"}})])],1),r("div",{staticClass:"main-right"},[r("p",{staticClass:"follow-name"},[t._v(t._s(t.follow.name))]),r("p",{staticClass:"text-muted"},[t._v(t._s(t.follow.account))]),r("p",[t._v(t._s(t.follow.introduction))])])]),r("div",{staticClass:"side-content"},[t.isProcessing?r("button",{staticClass:"btn btn-sm btn-primary follow-button",attrs:{type:"button",disabled:""}},[t._v(" 處理中 ")]):[t.follow.isFollowed&&t.currentUserId!==t.follow.followId?r("button",{staticClass:"btn btn-sm btn-primary follow-button",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteFollow(t.follow.followId)}}},[t._v(" 正在跟隨 ")]):t._e(),t.follow.isFollowed||t.currentUserId===t.follow.followId?t._e():r("button",{staticClass:"btn btn-sm btn-outline-primary follow-button",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addFollow(t.follow.followId)}}},[t._v(" 跟隨 ")])]],2)])},a=[],n=r("1da1"),s=r("5530"),i=(r("96cf"),r("a9e3"),r("159b"),r("604d")),l=r("2fa3"),c=r("2708"),u=r("2f62"),f=r("56d7"),d={name:"UserCard",mixins:[c["a"]],props:{initialFollow:{type:Object,required:!0},currentUserId:{type:Number,default:-1}},data:function(){return{follow:this.initialFollow,isProcessing:!1}},computed:Object(s["a"])({},Object(u["b"])(["currentUser","recommendation"])),methods:{socketFollow:function(t){var e={type:"follow",userId:this.currentUser.id,followId:t};f["socket"].emit("sendNotification",e)},addFollow:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var o,a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,o={id:t},e.isProcessing=!0,r.next=5,i["a"].addFollow({payLoad:o});case 5:if(a=r.sent,n=a.data,e.isProcessing=!1,"success"===n.status){r.next=10;break}throw new Error(n.message);case 10:e.follow.isFollowed=!0,e.socketFollow(t),e.$store.commit("followRecommendation",parseInt(t)),r.next=20;break;case 15:r.prev=15,r.t0=r["catch"](0),l["a"].fire({icon:"error",title:"無法追蹤使用者，請稍後再試"}),e.isProcessing=!1,console.log(r.t0);case 20:case"end":return r.stop()}}),r,null,[[0,15]])})))()},deleteFollow:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,r.next=4,i["a"].removeFollow({followId:t});case 4:if(o=r.sent,a=o.data,e.isProcessing=!1,"success"===a.status){r.next=9;break}throw new Error(a.message);case 9:e.follow.isFollowed=!1,e.$emit("after-delete-follow",t),e.$store.commit("unfollowRecommendation",parseInt(t)),r.next=19;break;case 14:r.prev=14,r.t0=r["catch"](0),l["a"].fire({icon:"error",title:"無法退追使用者，請稍後再試"}),e.isProcessing=!1,console.log(r.t0);case 19:case"end":return r.stop()}}),r,null,[[0,14]])})))()}},watch:{initialFollow:function(){this.follow=this.initialFollow},recommendation:function(t){var e=this;t.forEach((function(t){t.id===parseInt(e.follow.followId)&&(e.follow=Object(s["a"])(Object(s["a"])({},e.follow),{},{isFollowed:t.isFollowed}))}))}}},w=d,p=(r("aad5"),r("2877")),m=Object(p["a"])(w,o,a,!1,null,"7752cce1",null);e["a"]=m.exports},"369c":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main"},[r("div",{staticClass:"column-left column"},[r("Navbar")],1),r("div",{staticClass:"column-main column"},[r("div",{staticClass:"card main-content"},[r("ul",{staticClass:"list-group list-group-flush"},[r("PageHead",{attrs:{user:t.user}}),r("UserFollowsNavTabs"),t.isLoading?r("p",{staticClass:"loading"},[t._v("努力加載中...")]):t._l(t.followers,(function(e){return r("UserCard",{key:e.id,attrs:{"initial-follow":e,currentUserId:t.currentUser.id}})}))],2)])]),r("div",{staticClass:"column-right column"},[r("Recommendation",{attrs:{"user-id":t.user.id}})],1)])},a=[],n=r("5530"),s=r("1da1"),i=(r("d81d"),r("96cf"),r("d178")),l=r("cb06"),c=r("f0b3"),u=r("2957"),f=r("74ca"),d=r("4cce"),w=r("2fa3"),p=r("2f62"),m={name:"UserFollowers",components:{Navbar:i["a"],PageHead:l["a"],UserFollowsNavTabs:c["a"],UserCard:u["a"],Recommendation:f["a"]},data:function(){return{user:{},followers:[],isLoading:!0}},methods:{fetchUser:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,d["a"].get({userId:t});case 3:o=r.sent,a=o.data,e.user=a,r.next=12;break;case 8:r.prev=8,r.t0=r["catch"](0),console.log(r.t0),w["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))()},fetchFollowers:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,d["a"].getFollowers({userId:t});case 3:o=r.sent,a=o.data,e.isLoading=!1,e.followers=a.map((function(t){return Object(n["a"])(Object(n["a"])({},t),{},{followId:t.followerId})})),r.next=14;break;case 9:r.prev=9,r.t0=r["catch"](0),e.isLoading=!1,console.log(r.t0),w["a"].fire({icon:"error",title:"無法取得使用者追蹤清單，請稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,9]])})))()}},beforeRouteUpdate:function(t,e,r){var o=t.params.id;this.fetchFollowers(o),r()},computed:Object(n["a"])({},Object(p["b"])(["currentUser"])),created:function(){var t=this.$route.params.id;this.fetchUser(t),this.fetchFollowers(t)}},v=m,b=(r("97f9"),r("2877")),h=Object(b["a"])(v,o,a,!1,null,"0d43c7a8",null);e["default"]=h.exports},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,r){var o=r("1d80"),a=r("5899"),n="["+a+"]",s=RegExp("^"+n+n+"*"),i=RegExp(n+n+"*$"),l=function(t){return function(e){var r=String(o(e));return 1&t&&(r=r.replace(s,"")),2&t&&(r=r.replace(i,"")),r}};t.exports={start:l(1),end:l(2),trim:l(3)}},"6d57":function(t,e,r){},7156:function(t,e,r){var o=r("861d"),a=r("d2bb");t.exports=function(t,e,r){var n,s;return a&&"function"==typeof(n=e.constructor)&&n!==r&&o(s=n.prototype)&&s!==r.prototype&&a(t,s),t}},"97f9":function(t,e,r){"use strict";r("6d57")},a9e3:function(t,e,r){"use strict";var o=r("83ab"),a=r("da84"),n=r("94ca"),s=r("6eeb"),i=r("5135"),l=r("c6b6"),c=r("7156"),u=r("c04e"),f=r("d039"),d=r("7c73"),w=r("241c").f,p=r("06cf").f,m=r("9bf2").f,v=r("58a8").trim,b="Number",h=a[b],g=h.prototype,I=l(d(g))==b,F=function(t){var e,r,o,a,n,s,i,l,c=u(t,!1);if("string"==typeof c&&c.length>2)if(c=v(c),e=c.charCodeAt(0),43===e||45===e){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:o=2,a=49;break;case 79:case 111:o=8,a=55;break;default:return+c}for(n=c.slice(2),s=n.length,i=0;i<s;i++)if(l=n.charCodeAt(i),l<48||l>a)return NaN;return parseInt(n,o)}return+c};if(n(b,!h(" 0o1")||!h("0b1")||h("+0x1"))){for(var C,_=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof _&&(I?f((function(){g.valueOf.call(r)})):l(r)!=b)?c(new h(F(e)),r,_):F(e)},k=o?w(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),N=0;k.length>N;N++)i(h,C=k[N])&&!i(_,C)&&m(_,C,p(h,C));_.prototype=g,g.constructor=_,s(a,b,_)}},aad5:function(t,e,r){"use strict";r("cb95")},c08f:function(t,e,r){"use strict";r("1c9f")},cb95:function(t,e,r){},f0b3:function(t,e,r){"use strict";var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"nav nav-pills"},[r("li",{staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"user-followers",params:{id:t.id}}}},[t._v(" 跟隨者 ")])],1),r("li",{staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{name:"user-followings",params:{id:t.id}}}},[t._v(" 正在跟隨 ")])],1)])},a=[],n={name:"UserFollowsNavTabs",data:function(){return{id:-1}},created:function(){var t=this.$route.params.id;this.id=t}},s=n,i=(r("c08f"),r("2877")),l=Object(i["a"])(s,o,a,!1,null,"b8ab7340",null);e["a"]=l.exports}}]);
//# sourceMappingURL=chunk-172e0591.e288080d.js.map