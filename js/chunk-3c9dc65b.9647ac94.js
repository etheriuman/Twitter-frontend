(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c9dc65b"],{4731:function(t,e,s){"use strict";s("5460")},5460:function(t,e,s){},"6c0d":function(t,e,s){"use strict";s("ae06")},"6f1a":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[s("div",{staticClass:"column-left column"},[s("Navbar",{on:{"after-submit":t.handleAfterSubmit}})],1),s("div",{staticClass:"column-main column"},[s("div",{staticClass:"card main-content"},[s("ul",{staticClass:"list-group list-group-flush"},[s("PageHead"),s("TweetExtend",{attrs:{"initial-tweet":t.tweet},on:{"after-add-like":t.handleAfterAddLike,"after-delete-like":t.handleAfterDeleteLike,"after-reply":t.handleAfterReply}}),t._l(t.tweet.Replies,(function(t){return s("ReplyCard",{key:t.id,attrs:{reply:t}})}))],2)])]),s("div",{staticClass:"column-right column"},[s("Recommendation")],1)])},i=[],n=s("5530"),r=s("1da1"),c=(s("96cf"),s("d178")),o=s("cb06"),l=s("74ca"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isLoading?t._e():s("div",{staticClass:"list-group-item"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"card-body-content"},[s("div",{staticClass:"content-header"},[s("router-link",{attrs:{to:{name:"user-tweets",params:{id:t.tweet.User.id}}}},[s("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.tweet.User.avatar),alt:""}})]),s("div",{staticClass:"content-header-description"},[s("p",[s("span",{staticClass:"user-name"},[t._v(t._s(t.tweet.User.name))])]),s("p",[s("span",{staticClass:"text-muted"},[t._v(t._s(t.tweet.User.account))])])])],1),s("div",{staticClass:"content-body"},[s("p",{staticClass:"description text-exlg"},[t._v(t._s(t.tweet.description))]),s("p",[s("span",{staticClass:"text-muted"},[t._v(t._s(t._f("time")(t.tweet.createdAt)))]),s("span",{staticClass:"text-muted"},[t._v(" ‧ ")]),s("span",{staticClass:"text-muted"},[t._v(t._s(t._f("date")(t.tweet.createdAt)))])])]),s("div",{staticClass:"content-belly"},[s("span",{staticClass:"text-lg"},[t._v(t._s(t.tweet.repliesNumber)+" "),s("span",{staticClass:"text-muted"},[t._v("回覆")])]),s("span",{staticClass:"text-lg"},[t._v(t._s(t.tweet.likesNumber)+" "),s("span",{staticClass:"text-muted"},[t._v("喜歡次數")])])]),s("div",{staticClass:"content-footer text-lg"},[s("div",{staticClass:"reply"},[s("font-awesome-icon",{staticClass:"icon",attrs:{icon:"comment","data-toggle":"modal","data-target":"#"+t.replyingId}})],1),t.isProcessing?s("div",{staticClass:"like text-muted"},[s("font-awesome-icon",{staticClass:"icon",attrs:{icon:"heart"}})],1):[t.tweet.isLiked?s("div",{staticClass:"liked"},[s("font-awesome-icon",{staticClass:"icon",attrs:{icon:"heart"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteLike(t.tweet.id)}}})],1):s("div",{staticClass:"like"},[s("font-awesome-icon",{staticClass:"icon",attrs:{icon:"heart"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addLike(t.tweet.id)}}})],1)]],2)])]),s("Replying",{attrs:{"replying-tweet":t.tweet,"replying-id":t.replyingId}})],1)},u=[],p=s("8d31"),m=s("2708"),f=s("c058"),w=s("2f62"),v=s("2fa3"),h=s("56d7"),g={components:{Replying:p["a"]},props:{initialTweet:{type:Object,required:!0}},data:function(){return{tweet:this.initialTweet,replyingId:"",isLoading:!0,isProcessing:!1}},computed:Object(n["a"])({},Object(w["b"])(["currentUser"])),methods:{addLike:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var a,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,e.isProcessing=!0,s.next=4,f["a"].addLike({tweetId:t});case 4:if(a=s.sent,i=a.data,"success"===i.status){s.next=8;break}throw new Error(i.message);case 8:e.isProcessing=!1,e.$emit("after-add-like",e.tweet.id),e.socketLike(),s.next=18;break;case 13:s.prev=13,s.t0=s["catch"](0),v["a"].fire({icon:"error",title:"無法按讚，請稍後再試"}),e.isProcessing=!1,console.log(s.t0);case 18:case"end":return s.stop()}}),s,null,[[0,13]])})))()},socketLike:function(){var t={type:"like",userId:this.currentUser.id,tweetId:this.tweet.id};h["socket"].emit("sendNotification",t)},deleteLike:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var a,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,e.isProcessing=!0,s.next=4,f["a"].cancelLike({tweetId:t});case 4:if(a=s.sent,i=a.data,"success"===i.status){s.next=8;break}throw new Error(i.message);case 8:e.isProcessing=!1,e.$emit("after-delete-like",e.tweet.id),s.next=17;break;case 12:s.prev=12,s.t0=s["catch"](0),v["a"].fire({icon:"error",title:"無法取消讚，請稍後再試"}),e.isProcessing=!1,console.log(s.t0);case 17:case"end":return s.stop()}}),s,null,[[0,12]])})))()}},watch:{initialTweet:function(t){this.tweet=Object(n["a"])(Object(n["a"])({},this.tweet),t),this.replyingId="replying".concat(t.id),this.isLoading=!1}},mixins:[m["b"],m["c"],m["a"]]},b=g,k=(s("4731"),s("2877")),C=Object(k["a"])(b,d,u,!1,null,"0e00798e",null),_=C.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-group-item"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"card-body-side"},[s("router-link",{attrs:{to:{name:"user-tweets",params:{id:t.reply.User.id}}}},[s("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.reply.User.avatar),alt:""}})])],1),s("div",{staticClass:"card-body-content"},[s("div",{staticClass:"content-header"},[s("span",{staticClass:"user-name"},[t._v(t._s(t.reply.User.name))]),s("span",{staticClass:"text-muted"},[t._v(t._s(t.reply.User.account))]),s("span",{staticClass:"text-muted"},[t._v(" ‧ ")]),s("span",{staticClass:"text-muted"},[t._v(t._s(t._f("fromNow")(t.reply.createdAt)))])]),s("div",{staticClass:"content-body"},[s("p",[t._v(t._s(t.reply.comment))])])])])])},x=[],O={props:{reply:{type:Object,required:!0}},watch:{initialTweet:function(t){this.tweet=Object(n["a"])(Object(n["a"])({},this.tweet),t)}},mixins:[m["b"],m["a"]]},j=O,L=(s("6c0d"),Object(k["a"])(j,y,x,!1,null,"4b003972",null)),R=L.exports,A=s("6783"),P={components:{Navbar:c["a"],PageHead:o["a"],Recommendation:l["a"],TweetExtend:_,ReplyCard:R},data:function(){return{tweet:{}}},methods:{handleAfterSubmit:function(){console.log("new tweet uploaded")},fetchTweet:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,A["a"].getTweet({tweetId:t});case 3:if(a=s.sent,"OK"===a.statusText){s.next=6;break}throw new Error(a.statusText);case 6:e.tweet=a.data,s.next=13;break;case 9:s.prev=9,s.t0=s["catch"](0),v["a"].fire({icon:"error",title:"無法取得推文資訊，請稍後再試"}),console.log(s.t0);case 13:case"end":return s.stop()}}),s,null,[[0,9]])})))()},handleAfterAddLike:function(){console.log("add like"),this.tweet=Object(n["a"])(Object(n["a"])({},this.tweet),{},{isLiked:!0,likesNumber:this.tweet.likesNumber+1})},handleAfterDeleteLike:function(){console.log("delete like"),this.tweet=Object(n["a"])(Object(n["a"])({},this.tweet),{},{isLiked:!1,likesNumber:this.tweet.likesNumber-1})},handleAfterReply:function(t){this.fetchTweet(t)}},created:function(){var t=this.$route.params.id;this.fetchTweet(t)}},T=P,I=(s("f83c"),Object(k["a"])(T,a,i,!1,null,"b1903e72",null));e["default"]=I.exports},9192:function(t,e,s){},ae06:function(t,e,s){},f83c:function(t,e,s){"use strict";s("9192")}}]);
//# sourceMappingURL=chunk-3c9dc65b.9647ac94.js.map