{"version":3,"sources":["webpack:///./src/views/UserReplies.vue?5941","webpack:///src/views/UserReplies.vue","webpack:///./src/views/UserReplies.vue?2380","webpack:///./src/views/UserReplies.vue","webpack:///./src/views/UserReplies.vue?9c0c"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","handleAfterSubmit","attrs","user","directives","name","rawName","value","userIsLoading","tweetsIsLoading","expression","handleAfterAddFollowed","handleAfterCencelFollowed","afterHandleSubmit","_l","tweet","key","id","handleAfterAddLike","handleAfterDeleteLike","staticRenderFns","components","Navbar","PageHead","UserProfile","TweetCard","Recommendation","data","tweets","methods","console","log","fetchTweetsLiked","map","tweetId","isLiked","likesNumber","handleAfterReply","replyData","repliesNumber","fetchUser","userId","beforeRouteUpdate","fetchReplies","next","created","component"],"mappings":"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","file":"js/chunk-3535888a.d705ff26.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main\"},[_c('div',{staticClass:\"column-left column\"},[_c('Navbar',{on:{\"after-submit\":_vm.handleAfterSubmit}})],1),_c('div',{staticClass:\"column-main column\"},[_c('div',{staticClass:\"card main-content\"},[_c('ul',{staticClass:\"list-group list-group-flush\"},[_c('PageHead',{attrs:{\"user\":_vm.user}}),_c('UserProfile',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.userIsLoading&&!_vm.tweetsIsLoading),expression:\"!userIsLoading&&!tweetsIsLoading\"}],attrs:{\"initial-user\":_vm.user},on:{\"afterAddFollowed\":_vm.handleAfterAddFollowed,\"afterCancelFollowed\":_vm.handleAfterCencelFollowed,\"afterSubmit\":_vm.afterHandleSubmit}}),_vm._l((_vm.tweets),function(tweet){return _c('TweetCard',{key:tweet.id,attrs:{\"initial-tweet\":tweet},on:{\"after-add-like\":_vm.handleAfterAddLike,\"after-delete-like\":_vm.handleAfterDeleteLike}})})],2)])]),_c('div',{staticClass:\"column-right column\"},[_c('Recommendation')],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"main\">\n    <div class=\"column-left column\">\n      <Navbar @after-submit=\"handleAfterSubmit\" />\n    </div>\n    <div class=\"column-main column\">\n      <div class=\"card main-content\">\n        <ul class=\"list-group list-group-flush\">\n          <PageHead :user=\"user\" />\n          <UserProfile\n            v-show=\"!userIsLoading&&!tweetsIsLoading\"\n            :initial-user=\"user\"\n            @afterAddFollowed=\"handleAfterAddFollowed\"\n            @afterCancelFollowed=\"handleAfterCencelFollowed\"\n            @afterSubmit=\"afterHandleSubmit\"\n          />\n          <TweetCard\n            v-for=\"tweet in tweets\"\n            :key=\"tweet.id\"\n            :initial-tweet=\"tweet\"\n            @after-add-like=\"handleAfterAddLike\"\n            @after-delete-like=\"handleAfterDeleteLike\"\n          />\n        </ul>\n      </div>\n    </div>\n    <div class=\"column-right column\">\n      <Recommendation />\n    </div>\n  </div>\n</template>\n\n<script>\nimport Navbar from \"./../components/Navbar\"\nimport PageHead from \"./../components/PageHead\"\nimport UserProfile from \"./../components/UserProfile\"\nimport TweetCard from \"./../components/TweetCard\"\nimport Recommendation from \"./../components/Recommendation\"\nimport usersApi from \"./../apis/users.js\"\nimport followApi from \"./../apis/follow.js\"\nimport { Toast } from \"./../utils/helpers.js\"\n\nexport default {\n  name: \"UserReplies\",\n  components: {\n    Navbar,\n    PageHead,\n    UserProfile,\n    TweetCard,\n    Recommendation,\n  },\n  data() {\n    return {\n      user: {},\n      tweets: [],\n      userIsLoading: true,\n      tweetsIsLoading: true\n    }\n  },\n  methods: {\n    async fetchUser(userId) {\n      try {\n        const {data} = await usersApi.get({userId})\n        this.user = data\n        this.userIsLoading = false\n      } catch (error) {\n        this.userIsLoading = false\n        console.log (error)\n        Toast.fire ({\n          icon: 'error',\n          title: '無法取得使用者資料，請稍後再試'\n        })\n      }  \n    },\n    async fetchReplies(userId) {\n      try {\n        const {data} = await usersApi.getRepliedTweets({userId})\n        this.tweets.push(...data)\n        this.tweetsIsLoading = false\n      } catch (error) {\n        this.tweetsIsLoading = false\n        console.log (error)\n        Toast.fire ({\n          icon: 'error',\n          title: '無法取得使用者推文回覆資料，請稍後再試'\n        })\n      }\n    },\n    handleAfterSubmit() {\n      // 因為需要取得正確createdAt所以選擇重新fetch一次\n      console.log(\"refetch\")\n      this.fetchTweetsLiked()\n    },\n    handleAfterAddLike(tweetId) {\n      console.log(\"add like\")\n      this.tweets = this.tweets.map((tweet) => {\n        if (tweet.id === tweetId) {\n          return {\n            ...tweet,\n            isLiked: true,\n            likesNumber: tweet.likesNumber + 1,\n          }\n        }\n        return tweet\n      })\n    },\n    handleAfterDeleteLike(tweetId) {\n      console.log(\"delete like\")\n      this.tweets = this.tweets.map((tweet) => {\n        if (tweet.id === tweetId) {\n          return {\n            ...tweet,\n            isLiked: false,\n            likesNumber: tweet.likesNumber - 1,\n          }\n        }\n        return tweet\n      })\n    },\n    handleAfterReply(replyData) {\n      console.log(\"replied\")\n      console.log(replyData)\n      const { tweetId } = replyData\n      this.tweets = this.tweets.map((tweet) => {\n        if (tweet.id === tweetId) {\n          console.log(\"this tweet is\", tweet)\n          return {\n            ...tweet,\n            repliesNumber: tweet.repliesNumber + 1,\n          }\n        }\n        return tweet\n      })\n    },\n    async handleAfterAddFollowed(payLoad) {\n      try {\n        const {data} = await followApi.addFollow({payLoad})\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n        this.user.isFollowed = true\n      } catch (error) {\n        console.log (error)\n        Toast.fire ({\n          icon: 'error',\n          title: '無法將使用者加入追蹤，請稍後再試'\n        })\n      }      \n    },\n    async handleAfterCencelFollowed(userId) {\n      try {\n        const {data} = await followApi.removeFollow({followId:userId})\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n        this.user.isFollowed = false\n      } catch (error) {\n        console.log (error)\n        Toast.fire ({\n          icon: 'error',\n          title: '無法將使用者移除追蹤，請稍後再試'\n        })\n      } \n    },\n    afterHandleSubmit() {\n      const { id: userId } = this.$route.params\n      this.fetchUser(userId)\n    }\n  },\n  //監聽切換頁面的事件\n  beforeRouteUpdate(to,from,next) {\n    const {id : userId} = to.params\n    this.fetchUser(userId)\n    this.fetchReplies(userId)\n    next()\n  },\n  created() {\n    const { id: userId } = this.$route.params\n    this.fetchUser(userId)\n    this.fetchReplies(userId)\n  },\n}\n</script>\n\n<style scoped>\n.main {\n  grid-template-columns: 220px 1fr 300px;\n  grid-template-areas: \"left main right\";\n}\n\n/* pad 尺寸 */\n@media screen and (max-width: 992px) {\n  .main {\n    grid-template-rows: calc(100% - 50px) 50px;\n    grid-template-columns: 1fr 300px;\n    grid-template-areas:\n      \"main right\"\n      \"left left\";\n  }\n}\n\n/* mobile 尺寸 */\n@media screen and (max-width: 768px) {\n  .main {\n    grid-template-rows: calc(100% - 50px) 50px;\n    grid-template-columns: 1fr 300px;\n    grid-template-areas:\n      \"main main\"\n      \"left left\";\n  }\n  .column-right {\n    display: none;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserReplies.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserReplies.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserReplies.vue?vue&type=template&id=0e2d9f44&scoped=true&\"\nimport script from \"./UserReplies.vue?vue&type=script&lang=js&\"\nexport * from \"./UserReplies.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserReplies.vue?vue&type=style&index=0&id=0e2d9f44&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0e2d9f44\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserReplies.vue?vue&type=style&index=0&id=0e2d9f44&scoped=true&lang=css&\""],"sourceRoot":""}