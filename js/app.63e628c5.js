(function(t){function e(e){for(var r,s,o=e[0],c=e[1],u=e[2],l=0,d=[];l<o.length;l++)s=o[l],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);f&&f(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,s=1;s<n.length;s++){var o=n[s];0!==a[o]&&(r=!1)}r&&(i.splice(e--,1),t=c(c.s=n[0]))}return t}var r={},s={app:0},a={app:0},i=[];function o(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-1706dda0":"97cd8053","chunk-172e0591":"e288080d","chunk-2d0e5e97":"7954fa18","chunk-3c9dc65b":"9647ac94","chunk-57d9b9f2":"e249534c","chunk-5850b38c":"e4bc6713","chunk-64609941":"a049085c","chunk-692b9bce":"a7a3a75b","chunk-c26c6374":"6af0ff96","chunk-2acd8290":"0d4f67ac","chunk-3535888a":"d705ff26","chunk-b6684e42":"593b7be6","chunk-fd95591a":"e1e60ece","chunk-fdc244da":"ad5ba0fa"}[t]+".js"}function c(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-1706dda0":1,"chunk-172e0591":1,"chunk-3c9dc65b":1,"chunk-57d9b9f2":1,"chunk-5850b38c":1,"chunk-64609941":1,"chunk-692b9bce":1,"chunk-c26c6374":1,"chunk-2acd8290":1,"chunk-3535888a":1,"chunk-b6684e42":1,"chunk-fd95591a":1,"chunk-fdc244da":1};s[t]?e.push(s[t]):0!==s[t]&&n[t]&&e.push(s[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-1706dda0":"e00b0c15","chunk-172e0591":"a1e7c311","chunk-2d0e5e97":"31d6cfe0","chunk-3c9dc65b":"8c8ef861","chunk-57d9b9f2":"d86eb604","chunk-5850b38c":"1e234877","chunk-64609941":"7840d73e","chunk-692b9bce":"7399b6c0","chunk-c26c6374":"4adb9959","chunk-2acd8290":"15f28643","chunk-3535888a":"abcd95a6","chunk-b6684e42":"777a1e8d","chunk-fd95591a":"9747aa32","chunk-fdc244da":"d0c73a1b"}[t]+".css",a=c.p+r,i=document.getElementsByTagName("link"),o=0;o<i.length;o++){var u=i[o],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return e()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){u=d[o],l=u.getAttribute("data-href");if(l===r||l===a)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var r=e&&e.target&&e.target.src||a,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete s[t],f.parentNode.removeChild(f),n(i)},f.href=a;var m=document.getElementsByTagName("head")[0];m.appendChild(f)})).then((function(){s[t]=0})));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,n){r=a[t]=[e,n]}));e.push(r[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=o(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(f);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",d.name="ChunkLoadError",d.type=r,d.request=s,n[1](d)}a[t]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=r,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(n,r,function(e){return t[e]}.bind(null,r));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/twitter-frontend/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var f=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"10ca":function(t,e,n){},"12ab":function(t,e,n){},"20ae":function(t,e,n){"use strict";n("c771")},2708:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n("c1df"),s=n.n(r),a={filters:{fromNow:function(t){return t?s()(t).locale("zh-tw").fromNow():"-"}}},i={filters:{date:function(t){return t?s()(t).locale("zh-tw").format("ll"):"-"},time:function(t){return t?s()(t).locale("zh-tw").format("LT"):"-"}}},o={filters:{emptyImage:function(t){return t||"https://via.placeholder.com/400x200/DFDFDF?text=No+Image"}}}},"2fa3":function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l}));n("d3b7");var r=n("bc3a"),s=n.n(r),a=n("3d20"),i=n.n(a),o="https://twitter-simple-one.herokuapp.com/api",c=s.a.create({baseURL:o});c.interceptors.request.use((function(t){var e=localStorage.getItem("token");return e&&(t.headers["Authorization"]="Bearer ".concat(e)),t}),(function(t){return Promise.reject(t)}));var u=c,l=i.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})},4678:function(t,e,n){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=a(t);return n(e)}function a(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}s.keys=function(){return Object.keys(r)},s.resolve=a,t.exports=s,s.id="4678"},"471e":function(t,e,n){"use strict";n("dfb0")},"47c7":function(t,e,n){},"4cce":function(t,e,n){"use strict";var r=n("2fa3");e["a"]={getCurrentUser:function(){return r["b"].get("/get_current_user")},get:function(t){var e=t.userId;return r["b"].get("/users/".concat(e))},set:function(t){var e=t.userId,n=t.payLoad;return r["b"].put("/users/".concat(e),n)},getTweets:function(t){var e=t.userId;return r["b"].get("/users/".concat(e,"/tweets"))},getRepliedTweets:function(t){var e=t.userId;return r["b"].get("/users/".concat(e,"/replied_tweets"))},getLikedTweets:function(t){var e=t.userId;return r["b"].get("/users/".concat(e,"/likes"))},getFollowings:function(t){var e=t.userId;return r["b"].get("/users/".concat(e,"/followings"))},getFollowers:function(t){var e=t.userId;return r["b"].get("/users/".concat(e,"/followers"))},getTopUsers:function(){return r["b"].get("/topusers")}}},"56d7":function(t,e,n){"use strict";n.r(e),n.d(e,"socket",(function(){return bt}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"twitter-frontend"}},[n("router-view")],1)},a=[],i=(n("4989"),n("ab8b"),{name:"App",created:function(){bt.on("connect",(function(){console.log("connected!!!")})),bt.on("disconnect",(function(t){console.log("socket disconnected:",t)})),bt.on("connect_error",(function(t){console.log("connect error: ",t.message)}))}}),o=i,c=(n("034f"),n("2877")),u=Object(c["a"])(o,s,a,!1,null,null,null),l=u.exports,d=n("1da1"),f=n("2909"),m=n("5530"),p=(n("96cf"),n("d81d"),n("b0c0"),n("2f62")),b=n("4cce");r["a"].use(p["a"]);var h=new p["a"].Store({state:{currentUser:{id:-1,name:"",account:"",email:"",avatar:"",cover:"",introduction:"",role:""},isAuthenticated:!1,token:"",recommendation:[]},mutations:{setCurrentUser:function(t,e){t.currentUser=Object(m["a"])(Object(m["a"])({},t.currentUser),e),t.token=localStorage.getItem("token"),t.isAuthenticated=!0},revokeAuthentication:function(t){t.currentUser={},t.isAuthenticated=!1,localStorage.removeItem("token"),localStorage.removeItem("userId"),t.token=""},setRecommendation:function(t,e){t.recommendation=Object(f["a"])(e)},followRecommendation:function(t,e){t.recommendation=t.recommendation.map((function(t){return t.id===e?Object(m["a"])(Object(m["a"])({},t),{},{followerCount:t.followerCount++,isFollowed:!0}):t}))},unfollowRecommendation:function(t,e){t.recommendation=t.recommendation.map((function(t){return t.id===e?Object(m["a"])(Object(m["a"])({},t),{},{followerCount:t.followerCount--,isFollowed:!1}):t}))}},actions:{fetchCurrentUser:function(t){return Object(d["a"])(regeneratorRuntime.mark((function e(){var n,r,s,a,i,o,c,u,l,d,f;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.prev=1,console.log("setCurrentUser"),e.next=5,b["a"].getCurrentUser();case 5:if(r=e.sent,s=r.data,"error"!==s.status){e.next=9;break}throw new Error(s.message);case 9:return a=s.id,i=s.name,o=s.account,c=s.email,u=s.avatar,l=s.role,d=s.cover,f=s.introduction,n("setCurrentUser",{id:a||-1,name:i||"",account:o||"",email:c||"",avatar:u||"",role:l||"",cover:d||"",introduction:f||""}),e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e["catch"](1),console.log(e.t0),n("revokeAuthentication"),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[1,14]])})))()}},modules:{}}),v=n("8e27"),g=(n("d3b7"),n("3ca3"),n("ddb0"),n("caad"),n("2532"),n("8c4f")),w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[t._m(0),t._m(1),n("form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleFormSubmit(e)}}},[n("div",{staticClass:"form-label-group"},[n("label",{attrs:{for:"account"}},[t._v("帳號")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],ref:"account",staticClass:"form-control",attrs:{id:"account",name:"account",type:"text",autocomplete:"useraccount",required:"",autofocus:""},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),n("div",{staticClass:"form-label-group"},[n("label",{attrs:{for:"password"}},[t._v("密碼")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{id:"password",name:"password",type:"password",autocomplete:"new-password",required:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),n("div",{staticClass:"form-label-group button-div"},[n("button",{staticClass:"btn btn-primary btn-block submit-button",attrs:{disabled:t.isProcessing,type:"submit"}},[t._v(" 登入 ")])]),n("div",{staticClass:"form-bottom"},[n("router-link",{staticClass:"text-secondary",attrs:{to:"/signup"}},[t._v(" 註冊 Alphitter ")]),n("span",{staticClass:"text-muted"},[t._v(" · ")]),n("router-link",{staticClass:"text-secondary",attrs:{to:"/admin/signin"}},[t._v(" 後台登入 ")])],1)])])},k=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"logo-bar header"},[r("img",{attrs:{src:n("ad30"),alt:"logo"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title-bar header"},[n("span",[t._v("登入Alphitter")])])}],j=n("2fa3"),C={users:{signIn:function(t){var e=t.payLoad;return j["b"].post("/signin",e)}},admin:{signIn:function(t){var e=t.payLoad;return j["b"].post("/admin/signin",e)}}},y={data:function(){return{account:"",password:"",isProcessing:!1}},methods:{sendOnline:function(){var t={userId:this.currentUser.id};console.log("send online: ",t),bt.emit("sendOnline",t)},handleFormSubmit:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.account){e.next=4;break}return j["a"].fire({icon:"warning",title:"請輸入帳號"}),e.abrupt("return");case 4:if(t.password){e.next=7;break}return j["a"].fire({icon:"warning",title:"請輸入密碼"}),e.abrupt("return");case 7:return n={account:t.account,password:t.password},t.isProcessing=!0,e.next=11,C.users.signIn({payLoad:n});case 11:if(r=e.sent,s=r.data,"success"===s.status){e.next=15;break}throw new Error(s.message);case 15:localStorage.setItem("token",s.token),localStorage.setItem("userId",s.user.id),t.$store.commit("setCurrentUser",s.user),console.log("current socket object: ",bt),console.log("socket connect request sent!"),t.sendOnline(),t.$router.push("/tweets"),e.next=29;break;case 24:e.prev=24,e.t0=e["catch"](0),j["a"].fire({icon:"warning",title:"請確認輸入了正確的帳號密碼"}),t.isProcessing=!1,console.log(e.t0);case 29:case"end":return e.stop()}}),e,null,[[0,24]])})))()},autoFocus:function(){this.$refs.account.focus()}},computed:Object(m["a"])({},Object(p["b"])(["currentUser"])),mounted:function(){this.autoFocus()}},_=y,x=(n("20ae"),Object(c["a"])(_,w,k,!1,null,"6b1eb771",null)),P=x.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("div",{staticClass:"column-left column"},[n("Navbar",{on:{"after-submit":t.handleAfterSubmit}})],1),n("div",{staticClass:"column-main column"},[n("div",{staticClass:"card main-content"},[n("ul",{staticClass:"list-group list-group-flush"},[n("PageHead"),n("NewTweet",{on:{"after-submit":t.handleAfterSubmit}}),t.isLoading?n("p",{staticClass:"loading"},[t._v("努力加載中...")]):t._l(t.tweets,(function(e){return n("TweetCard",{key:e.id,attrs:{"initial-tweet":e},on:{"after-add-like":t.handleAfterAddLike,"after-delete-like":t.handleAfterDeleteLike,"after-reply":t.handleAfterReply}})}))],2)])]),n("div",{staticClass:"column-right column"},[n("Recommendation")],1)])},O=[],U=n("d178"),N=n("cb06"),T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list-group-item"},[n("form",{staticClass:"card-body",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit(e)}}},[n("div",{staticClass:"card-body-side"},[n("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.currentUser.avatar),alt:""}})]),n("div",{staticClass:"card-body-content"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"tweeting-area",attrs:{type:"textarea",placeholder:"說些什麼吧？",required:""},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),t._v(" "),n("button",{staticClass:"tweeting-submit btn btn-primary",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(" 推文 ")])])])])},R=[],E=(n("a4d3"),n("e01a"),n("6783")),$=n("2708"),L={data:function(){return{description:"",isProcessing:!1}},computed:Object(m["a"])({},Object(p["b"])(["currentUser"])),mixins:[$["a"]],methods:{sendNewTweet:function(){var t={type:"tweet",userId:this.currentUser.id,description:this.description};bt.emit("sendNotification",t)},handleSubmit:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var n,r,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.description.length,n){e.next=5;break}return j["a"].fire({icon:"warning",title:"請輸入推文內容"}),e.abrupt("return");case 5:if(!(n>140)){e.next=8;break}return j["a"].fire({icon:"warning",title:"推文字數過長，請小於140字"}),e.abrupt("return");case 8:return r={description:t.description},t.isProcessing=!0,e.next=12,E["a"].createTweet({payLoad:r});case 12:if(s=e.sent,a=s.data,"success"===a.status){e.next=16;break}throw new Error(a.message);case 16:t.isProcessing=!1,t.$emit("after-submit"),t.sendNewTweet(),t.description="",e.next=27;break;case 22:e.prev=22,e.t0=e["catch"](0),j["a"].fire({icon:"error",title:"無法新增推文，請稍後再試"}),t.isProcessing=!1,console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[0,22]])})))()}}},A=L,S=(n("8dba"),Object(c["a"])(A,T,R,!1,null,"4d382991",null)),D=S.exports,F=n("8f7b"),z=n("74ca"),q={components:{Navbar:U["a"],PageHead:N["a"],NewTweet:D,TweetCard:F["a"],Recommendation:z["a"]},data:function(){return{tweets:[],isLoading:!0}},methods:{fetchTweets:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E["a"].getTweets();case 3:if(n=e.sent,t.isLoading=!1,"OK"===n.statusText){e.next=7;break}throw new Error(n.statusText);case 7:t.tweets=n.data,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),j["a"].fire({icon:"error",title:"無法取得推文，請稍後再試"}),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()},handleAfterSubmit:function(){this.fetchTweets()},handleAfterAddLike:function(t){console.log("add like"),this.tweets=this.tweets.map((function(e){return e.id===t?Object(m["a"])(Object(m["a"])({},e),{},{isLiked:!0,likesNumber:e.likesNumber+1}):e}))},handleAfterDeleteLike:function(t){console.log("delete like"),this.tweets=this.tweets.map((function(e){return e.id===t?Object(m["a"])(Object(m["a"])({},e),{},{isLiked:!1,likesNumber:e.likesNumber-1}):e}))},handleAfterReply:function(t){this.tweets=this.tweets.map((function(e){return e.id===t?(console.log("this tweet is",e),Object(m["a"])(Object(m["a"])({},e),{},{repliesNumber:e.repliesNumber+1})):e}))}},created:function(){this.fetchTweets()}},M=q,B=(n("bff8"),Object(c["a"])(M,I,O,!1,null,"073f3655",null)),H=B.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[t._m(0),t._m(1),n("form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleFormSubmit(e)}}},[n("div",{staticClass:"form-label-group"},[n("label",{attrs:{for:"account"}},[t._v("帳號")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],ref:"account",staticClass:"form-control",attrs:{id:"account",name:"account",type:"text",autocomplete:"useraccount",required:"",autofocus:""},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),n("div",{staticClass:"form-label-group"},[n("label",{attrs:{for:"password"}},[t._v("密碼")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{id:"password",name:"password",type:"password",autocomplete:"new-password",required:""},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),n("div",{staticClass:"form-label-group button-div"},[n("button",{staticClass:"btn btn-primary btn-block submit-button",attrs:{disabled:t.isProcessing,type:"submit"}},[t._v(" 登入 ")])]),n("div",{staticClass:"form-bottom"},[n("router-link",{staticClass:"text-secondary",attrs:{to:"/signin"}},[t._v(" 前台登入 ")])],1)])])},J=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"logo-bar header"},[r("img",{attrs:{src:n("ad30"),alt:"logo"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title-bar header"},[n("span",[t._v("後台登入")])])}],G={data:function(){return{account:"",password:"",isProcessing:!1}},methods:{handleFormSubmit:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.account){e.next=4;break}return j["a"].fire({icon:"warning",title:"請輸入帳號"}),e.abrupt("return");case 4:if(t.password){e.next=7;break}return j["a"].fire({icon:"warning",title:"請輸入密碼"}),e.abrupt("return");case 7:return n={account:t.account,password:t.password},t.isProcessing=!0,e.next=11,C.admin.signIn({payLoad:n});case 11:if(r=e.sent,s=r.data,"success"===s.status){e.next=15;break}throw new Error(s.message);case 15:localStorage.setItem("token",s.token),t.$store.commit("setCurrentUser",s.user),t.$router.push("/admin/tweets"),e.next=25;break;case 20:e.prev=20,e.t0=e["catch"](0),j["a"].fire({icon:"warning",title:"請確認輸入了正確的帳號密碼"}),t.isProcessing=!1,console.log(e.t0);case 25:case"end":return e.stop()}}),e,null,[[0,20]])})))()},autoFocus:function(){this.$refs.account.focus()}},mounted:function(){this.autoFocus()}},Q=G,V=(n("cb54"),Object(c["a"])(Q,K,J,!1,null,"439300f8",null)),W=V.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("div",{staticClass:"column-left column"},[n("AdminNavbar")],1),n("div",{staticClass:"column-main column"},[n("div",{staticClass:"card main-content"},[n("ul",{staticClass:"list-group list-group-flush"},[n("PageHead"),t.isLoading?n("p",{staticClass:"loading"},[t._v("努力加載中...")]):t._l(t.tweets,(function(e){return n("TweetCard",{key:e.id,attrs:{"initial-tweet":e},on:{"after-delete-tweet":t.handleAfterDeleteTweet}})}))],2)])])])},Y=[],Z=(n("4de4"),n("7d03")),tt=n("be6c"),et={components:{AdminNavbar:Z["a"],PageHead:N["a"],TweetCard:F["a"]},data:function(){return{tweets:[],isLoading:!0}},methods:{fetchTweets:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,tt["a"].getTweets();case 3:if(n=e.sent,t.isLoading=!1,"OK"===n.statusText){e.next=7;break}throw new Error(n.statusText);case 7:t.tweets=n.data,console.log(n.data),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),j["a"].fire({icon:"error",title:"無法取得推文串，請稍後再試"});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},handleAfterDeleteTweet:function(t){this.tweets=this.tweets.filter((function(e){return e.id!==t}))}},created:function(){this.fetchTweets()}},nt=et,rt=(n("ff8c"),Object(c["a"])(nt,X,Y,!1,null,"baa9c432",null)),st=rt.exports;r["a"].use(g["a"]);var at=function(t,e,n){var r=h.state.currentUser;r&&"admin"!==r.role?n("/404"):n()},it=function(t,e,n){var r=h.state.currentUser;r&&"user"!==r.role?n("/404"):n()},ot=[{path:"/",name:"root",redirect:"/signin"},{path:"/signin",name:"sign-in",component:P},{path:"/signup",name:"sign-up",component:function(){return n.e("chunk-fdc244da").then(n.bind(null,"5c9c"))}},{path:"/setting",name:"setting",component:function(){return n.e("chunk-57d9b9f2").then(n.bind(null,"4ef5"))},beforeEnter:it},{path:"/tweets",name:"tweets",component:H,beforeEnter:it},{path:"/tweets/:id",name:"tweet",component:function(){return n.e("chunk-3c9dc65b").then(n.bind(null,"6f1a"))},beforeEnter:it},{path:"/users/:id",exact:!0,redirect:"/users/:id/tweets"},{path:"/users/:id/tweets",name:"user-tweets",component:function(){return Promise.all([n.e("chunk-c26c6374"),n.e("chunk-b6684e42")]).then(n.bind(null,"b2d0"))},beforeEnter:it},{path:"/users/:id/replies",name:"user-replies",component:function(){return Promise.all([n.e("chunk-c26c6374"),n.e("chunk-3535888a")]).then(n.bind(null,"79dd"))},beforeEnter:it},{path:"/users/:id/likes",name:"user-likes",component:function(){return Promise.all([n.e("chunk-c26c6374"),n.e("chunk-2acd8290")]).then(n.bind(null,"035c"))},beforeEnter:it},{path:"/users/:id/followings",name:"user-followings",component:function(){return n.e("chunk-1706dda0").then(n.bind(null,"e85a"))},beforeEnter:it},{path:"/users/:id/followers",name:"user-followers",component:function(){return n.e("chunk-172e0591").then(n.bind(null,"369c"))},beforeEnter:it},{path:"/chat/public",name:"chat-public",component:function(){return n.e("chunk-64609941").then(n.bind(null,"6565"))},beforeEnter:it},{path:"/chat/:id",name:"chat-private",component:function(){return n.e("chunk-692b9bce").then(n.bind(null,"47c3"))},beforeEnter:it},{path:"/notification",name:"notification",component:function(){return n.e("chunk-5850b38c").then(n.bind(null,"109a"))},beforeEnter:it},{path:"/admin",exact:!0,redirect:"/admin/signin"},{path:"/admin/signin",name:"admin-sign-in",component:W},{path:"/admin/tweets",name:"admin-tweets",component:st,beforeEnter:at},{path:"/admin/users",name:"admin-users",component:function(){return n.e("chunk-fd95591a").then(n.bind(null,"6135"))},beforeEnter:at},{path:"*",name:"not-found",component:function(){return n.e("chunk-2d0e5e97").then(n.bind(null,"9703"))}}],ct=new g["a"]({linkActiveClass:"text-primary",routes:ot});ct.beforeEach(function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(e,n,r){var s,a,i,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("move to page: ",e.name),s=h.state.currentUser.role,a=localStorage.getItem("token"),i=h.state.token,o=h.state.isAuthenticated,!a||a===i){t.next=9;break}return t.next=8,h.dispatch("fetchCurrentUser");case 8:o=t.sent;case 9:if(c=["sign-in","sign-up","admin-sign-in"],o||c.includes(e.name)){t.next=13;break}return r("/signin"),t.abrupt("return");case 13:if(!o||!c.includes(e.name)){t.next=19;break}if("admin"!==s){t.next=17;break}return r("/admin/tweets"),t.abrupt("return");case 17:return r("/tweets"),t.abrupt("return");case 19:r();case 20:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}());var ut=ct,lt=(n("12ab"),n("ecee")),dt=n("ad3d"),ft=n("c074");lt["c"].add(ft["j"],ft["n"],ft["d"],ft["a"],ft["e"],ft["i"],ft["h"],ft["g"],ft["b"],ft["c"],ft["m"],ft["f"],ft["k"],ft["l"]),r["a"].component("font-awesome-icon",dt["a"]),r["a"].config.productionTip=!1;var mt=localStorage.getItem("token")||"",pt=localStorage.getItem("userId")||-1,bt=Object(v["io"])("https://twitter-simple-one.herokuapp.com/",{auth:{token:mt,userId:pt}});new r["a"]({store:h,router:ut,render:function(t){return t(l)}}).$mount("#app")},"5a05":function(t,e,n){},"5c5c":function(t,e,n){"use strict";n("47c7")},"604d":function(t,e,n){"use strict";var r=n("2fa3");e["a"]={addFollow:function(t){var e=t.payLoad;return r["b"].post("/followships",e)},removeFollow:function(t){var e=t.followId;return r["b"].delete("/followships/".concat(e))}}},"61dc":function(t,e,n){"use strict";n("5a05")},6783:function(t,e,n){"use strict";var r=n("2fa3");e["a"]={getTweets:function(){return r["b"].get("/tweets")},createTweet:function(t){var e=t.payLoad;return r["b"].post("/tweets",e)},updateTweet:function(t){var e=t.tweetId,n=t.payLoad;return r["b"].put("/tweets/".concat(e),n)},getTweet:function(t){var e=t.tweetId;return r["b"].get("/tweets/".concat(e))},getTweetReplies:function(t){var e=t.tweetId;return r["b"].get("/tweets/".concat(e,"/replies"))},getTweetLikes:function(t){var e=t.tweetId;return r["b"].get("/tweets/".concat(e,"/likes"))}}},"6f04":function(t,e,n){},"74ca":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("ul",{staticClass:"list-group"},[n("li",{staticClass:"list-group-item"},[t._v(" 跟隨誰 ")]),n("div",{staticClass:"scroll-bar"},t._l(t.showingUsers,(function(e){return n("li",{key:e.id,staticClass:"list-group-item"},[n("div",{staticClass:"main-content"},[n("div",{staticClass:"main-left"},[n("router-link",{attrs:{to:{name:"user-tweets",params:{id:e.id}}}},[n("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.avatar),alt:"avatar"}})])],1),n("div",{staticClass:"main-right"},[n("p",[t._v(t._s(e.name))]),n("p",{staticClass:"text-muted"},[t._v(t._s(e.account))])])]),e.id!==t.currentUser.id?n("div",{staticClass:"side-content"},[e.isFollowed?n("button",{staticClass:"btn btn-sm btn-primary follow-button",attrs:{type:"button",disabled:e.id===t.isProcessingId},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.deleteFollow(e.id)}}},[t._v(" 正在跟隨 ")]):n("button",{staticClass:"btn btn-sm btn-outline-primary follow-button",attrs:{type:"button",disabled:e.id===t.isProcessingId},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.addFollow(e.id)}}},[t._v(" 跟隨 ")])]):t._e()])})),0),n("li",{staticClass:"list-group-item"},[t.recommendation.length!==t.showingUsers.length?n("button",{staticClass:"show-more",attrs:{type:"btn"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.showMoreUsers(t.showingUsers.length)}}},[t._v(" 顯示更多 ")]):n("button",{staticClass:"show-more",attrs:{type:"btn"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.showLessUsers(t.showingUsers.length)}}},[t._v(" 顯示更少 ")])])])])},s=[],a=n("1da1"),i=n("5530"),o=(n("fb6a"),n("96cf"),n("4cce")),c=n("604d"),u=n("2fa3"),l=n("2708"),d=n("2f62"),f=n("56d7"),m={data:function(){return{showingUsers:[],isProcessingId:-1,showingIndex:0}},computed:Object(i["a"])({},Object(d["b"])(["currentUser","recommendation"])),methods:{fetchUsers:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o["a"].getTopUsers();case 3:if(n=e.sent,"OK"===n.statusText){e.next=6;break}throw new Error(n.statusText);case 6:t.$store.commit("setRecommendation",n.data.users),t.showMoreUsers(t.showingIndex),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),u["a"].fire({icon:"error",title:"無法取得推薦名單，請稍後再試"});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},socketFollow:function(t){var e={type:"follow",userId:this.currentUser.id,followId:t};f["socket"].emit("sendNotification",e)},addFollow:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,r={id:t},e.isProcessingId=t,n.next=5,c["a"].addFollow({payLoad:r});case 5:if(s=n.sent,a=s.data,"success"===a.status){n.next=9;break}throw new Error(a.message);case 9:e.isProcessingId=-1,e.socketFollow(t),e.$store.commit("followRecommendation",t),n.next=19;break;case 14:n.prev=14,n.t0=n["catch"](0),u["a"].fire({icon:"error",title:"無法追蹤該使用者，請稍後再試"}),e.isProcessingId=-1,console.log(n.t0);case 19:case"end":return n.stop()}}),n,null,[[0,14]])})))()},deleteFollow:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.isProcessingId=t,n.next=4,c["a"].removeFollow({followId:t});case 4:if(r=n.sent,s=r.data,"success"===s.status){n.next=8;break}throw new Error(s.message);case 8:e.isProcessingId=-1,e.$store.commit("unfollowRecommendation",t),n.next=17;break;case 12:n.prev=12,n.t0=n["catch"](0),u["a"].fire({icon:"error",title:"無法退追該使用者，請稍後再試"}),e.isProcessingId=-1,console.log(n.t0);case 17:case"end":return n.stop()}}),n,null,[[0,12]])})))()},showMoreUsers:function(t){for(var e=t;e<t+6;e++){if(e===this.recommendation.length)return;this.showingUsers.push(this.recommendation[e])}},showLessUsers:function(){this.showingUsers=this.recommendation.slice(0,6)}},mixins:[l["a"]],watch:{showingUsers:function(t){this.showingUsers=t},recommendation:function(){var t=this.showingUsers.length;this.showingUsers=this.recommendation.slice(0,t)}},created:function(){this.fetchUsers()}},p=m,b=(n("c193"),n("2877")),h=Object(b["a"])(p,r,s,!1,null,"82f3531e",null);e["a"]=h.exports},"78dc":function(t,e,n){},"7d03":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"navbar"},[r("div",{staticClass:"upper-content"},[r("div",{staticClass:"logo"},[r("router-link",{attrs:{to:"/admin/tweets"}},[r("img",{attrs:{src:n("ad30"),alt:""}})])],1),r("div",{staticClass:"tabs"},[r("router-link",{staticClass:"tab",attrs:{to:"/admin/tweets"}},[r("font-awesome-icon",{attrs:{icon:"home"}}),r("span",[t._v("推文清單")])],1),r("router-link",{staticClass:"tab",attrs:{to:"/admin/users"}},[r("font-awesome-icon",{attrs:{icon:"user"}}),r("span",[t._v("使用者列表")])],1)],1)]),r("div",{staticClass:"lower-content"},[r("button",{staticClass:"logout btn",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.logout(e)}}},[r("font-awesome-icon",{attrs:{icon:"door-open"}}),r("span",[t._v("登出")])],1)])])},s=[],a={methods:{logout:function(){console.log("logout"),this.$store.commit("revokeAuthentication"),this.$router.push("/admin/signin")}}},i=a,o=(n("5c5c"),n("2877")),c=Object(o["a"])(i,r,s,!1,null,"ff1f8576",null);e["a"]=c.exports},"85ec":function(t,e,n){},"8d31":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"replying",staticClass:"modal fade",attrs:{id:t.replyingId,tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[t._m(0),n("div",{staticClass:"card-body"},[n("div",{staticClass:"card-body-side"},[n("router-link",{attrs:{to:{name:"user-tweets",params:{id:t.replyingTweet.User.id}}}},[n("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.replyingTweet.User.avatar),alt:""}})]),n("span",{staticClass:"line"})],1),n("div",{staticClass:"card-body-content"},[n("div",{staticClass:"content-header"},[n("span",{staticClass:"user-name"},[t._v(t._s(t.replyingTweet.User.name))]),n("span",{staticClass:"text-muted"},[t._v(t._s(t.replyingTweet.User.account))]),n("span",{staticClass:"text-muted"},[t._v(" ‧ ")]),n("span",{staticClass:"text-muted"},[t._v(t._s(t._f("fromNow")(t.replyingTweet.createdAt)))])]),n("div",{staticClass:"content-body"},[n("p",[t._v(t._s(t.replyingTweet.description))])]),n("div",{staticClass:"content-footer"},[n("p",[n("span",{staticClass:"text-muted"},[t._v("回覆給 ")]),n("span",{staticClass:"text-primary"},[t._v(t._s(t.replyingTweet.User.account))])])])])]),n("form",{staticClass:"modal-body",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit(t.replyingTweet.id)}}},[n("div",{staticClass:"modal-body-side"},[n("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.currentUser.avatar),alt:""}})]),n("div",{staticClass:"modal-body-content"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],ref:"replyingArea",staticClass:"replying-area",attrs:{type:"textarea",id:t.replyingId+"-textarea",placeholder:"說些什麼吧？",required:""},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}}),t._v(" "),n("button",{staticClass:"tweeting-submit btn btn-primary",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(" 回覆 ")])])])])])])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],a=n("1da1"),i=n("5530"),o=(n("96cf"),n("1157")),c=n.n(o),u=n("2fa3"),l={addReply:function(t){var e=t.tweetId,n=t.payLoad;return u["b"].post("/tweets/".concat(e,"/replies"),n)},updateReply:function(t){var e=t.replyId,n=t.payLoad;return u["b"].put("/replies/".concat(e),n)},deleteReply:function(t){var e=t.replyId;return u["b"].delete("/replies/".concat(e))}},d=n("2708"),f=n("2f62"),m=n("56d7"),p={props:{replyingTweet:{type:Object,required:!0},replyingId:{type:String,required:!0}},data:function(){return{comment:"",isProcessing:!1}},computed:Object(i["a"])({},Object(f["b"])(["currentUser"])),mixins:[d["b"],d["a"]],methods:{autoFocus:function(){this.$refs.replyingArea.focus()},cleanUp:function(){this.comment=""},socketReply:function(t){var e={type:"reply",userId:this.currentUser.id,tweetId:t,comment:this.comment};m["socket"].emit("sendNotification",e)},handleSubmit:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,r=e.comment.length,r){n.next=5;break}return u["a"].fire({icon:"warning",title:"請輸入回覆內容"}),n.abrupt("return");case 5:if(!(r>140)){n.next=8;break}return u["a"].fire({icon:"warning",title:"回覆字數過長，請小於140字"}),n.abrupt("return");case 8:return s={comment:e.comment},e.isProcessing=!0,n.next=12,l.addReply({tweetId:t,payLoad:s});case 12:if(a=n.sent,i=a.data,"success"===i.status){n.next=16;break}throw new Error(i.message);case 16:e.isProcessing=!1,e.$parent.$emit("after-reply",t),e.socketReply(t),e.cleanUp(),c()("#".concat(e.replyingId)).modal("hide"),n.next=28;break;case 23:n.prev=23,n.t0=n["catch"](0),u["a"].fire({icon:"error",title:"無法新增回覆，請稍後再試"}),e.isProcessing=!1,console.log(n.t0);case 28:case"end":return n.stop()}}),n,null,[[0,23]])})))()}},mounted:function(){c()(this.$refs.replying).on("shown.bs.modal",this.autoFocus),c()(this.$refs.replying).on("hidden.bs.modal",this.cleanUp)}},b=p,h=(n("ba34"),n("2877")),v=Object(h["a"])(b,r,s,!1,null,"1496ece3",null);e["a"]=v.exports},"8dba":function(t,e,n){"use strict";n("ed43")},"8f7b":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list-group-item"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"card-body-side"},["admin"!==t.currentUser.role?n("router-link",{attrs:{to:{name:"user-tweets",params:{id:t.tweet.User.id}}}},[n("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.tweet.User.avatar),alt:""}})]):[n("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.tweet.User.avatar),alt:""}})]],2),n("div",{staticClass:"card-body-content"},[n("div",{staticClass:"content-header"},[n("span",{staticClass:"user-name"},[t._v(t._s(t.tweet.User.name))]),n("span",{staticClass:"text-muted"},[t._v(t._s(t.tweet.User.account))]),n("span",{staticClass:"text-muted"},[t._v(" ‧ ")]),n("span",{staticClass:"text-muted"},[t._v(t._s(t._f("fromNow")(t.tweet.createdAt)))]),"admin"===t.currentUser.role?n("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteTweet(t.tweet.id)}}},[n("span",[t._v("×")])]):t._e()]),n("div",{staticClass:"content-body"},["user"===t.currentUser.role?n("router-link",{attrs:{to:{name:"tweet",params:{id:t.tweet.id}}}},[n("p",[t._v(t._s(t.tweet.description))])]):[n("p",[t._v(t._s(t.tweet.description))])]],2),"admin"!==t.currentUser.role?n("div",{staticClass:"content-footer"},[n("button",{staticClass:"reply btn",attrs:{"data-toggle":"modal","data-target":"#"+t.replyingId}},[n("font-awesome-icon",{staticClass:"icon",attrs:{icon:"comment"}}),n("span",[t._v(t._s(t.tweet.repliesNumber))])],1),t.isProcessing?n("button",{staticClass:"like btn text-muted"},[n("font-awesome-icon",{staticClass:"icon",attrs:{icon:"heart"}}),n("span",[t._v(t._s(t.tweet.likesNumber))])],1):[t.tweet.isLiked?n("button",{staticClass:"liked btn",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteLike(t.tweet.id)}}},[n("font-awesome-icon",{staticClass:"icon",attrs:{icon:"heart"}}),n("span",[t._v(t._s(t.tweet.likesNumber))])],1):n("button",{staticClass:"like btn",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addLike(t.tweet.id)}}},[n("font-awesome-icon",{staticClass:"icon",attrs:{icon:"heart"}}),n("span",[t._v(t._s(t.tweet.likesNumber))])],1)]],2):t._e()])]),n("Replying",{attrs:{"replying-tweet":t.tweet,"replying-id":t.replyingId}})],1)},s=[],a=n("1da1"),i=n("5530"),o=(n("96cf"),n("8d31")),c=n("c058"),u=n("be6c"),l=n("2fa3"),d=n("2f62"),f=n("2708"),m=n("56d7"),p={components:{Replying:o["a"]},computed:Object(i["a"])({},Object(d["b"])(["currentUser"])),props:{initialTweet:{type:Object,required:!0}},data:function(){return{tweet:this.initialTweet,replyingId:"replying".concat(this.initialTweet.id),isProcessing:!1}},methods:{addLike:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.isProcessing=!0,n.next=4,c["a"].addLike({tweetId:t});case 4:if(r=n.sent,s=r.data,"success"===s.status){n.next=8;break}throw new Error(s.message);case 8:e.isProcessing=!1,e.$emit("after-add-like",e.tweet.id),e.socketLike(),n.next=18;break;case 13:n.prev=13,n.t0=n["catch"](0),l["a"].fire({icon:"error",title:"無法按讚，請稍後再試"}),e.isProcessing=!1,console.log(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,13]])})))()},socketLike:function(){var t={type:"like",userId:this.currentUser.id,tweetId:this.tweet.id};m["socket"].emit("sendNotification",t)},deleteLike:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.isProcessing=!0,n.next=4,c["a"].cancelLike({tweetId:t});case 4:if(r=n.sent,s=r.data,"success"===s.status){n.next=8;break}throw new Error(s.message);case 8:e.isProcessing=!1,e.$emit("after-delete-like",e.tweet.id),n.next=17;break;case 12:n.prev=12,n.t0=n["catch"](0),l["a"].fire({icon:"error",title:"無法取消讚，請稍後再試"}),e.isProcessing=!1,console.log(n.t0);case 17:case"end":return n.stop()}}),n,null,[[0,12]])})))()},deleteTweet:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,e.isProcessing=!0,n.next=4,u["a"].deleteTweets({tweetId:t});case 4:if(r=n.sent,s=r.data,"success"===s.status){n.next=8;break}throw new Error(s.message);case 8:e.isProcessing=!1,e.$emit("after-delete-tweet",e.tweet.id),n.next=17;break;case 12:n.prev=12,n.t0=n["catch"](0),l["a"].fire({icon:"error",title:"無法刪除推文，請稍後再試"}),e.isProcessing=!1,console.log(n.t0);case 17:case"end":return n.stop()}}),n,null,[[0,12]])})))()}},watch:{initialTweet:function(t){this.tweet=Object(i["a"])(Object(i["a"])({},this.tweet),t)}},mixins:[f["b"],f["a"]]},b=p,h=(n("bb9d"),n("2877")),v=Object(h["a"])(b,r,s,!1,null,"2c04fafb",null);e["a"]=v.exports},ad30:function(t,e,n){t.exports=n.p+"img/Icon.50698f41.svg"},ba34:function(t,e,n){"use strict";n("78dc")},bb9d:function(t,e,n){"use strict";n("c9d0")},bbfd:function(t,e,n){},be6c:function(t,e,n){"use strict";var r=n("2fa3");e["a"]={getTweets:function(){return r["b"].get("/admin/tweets")},deleteTweets:function(t){var e=t.tweetId;return r["b"].delete("/admin/tweets/".concat(e))},getUsers:function(){return r["b"].get("/admin/users")},getLightUsers:function(){return r["b"].get("/admin/users/light")}}},bff8:function(t,e,n){"use strict";n("c3e9")},c058:function(t,e,n){"use strict";var r=n("2fa3");e["a"]={addLike:function(t){var e=t.tweetId;return r["b"].post("/tweets/".concat(e,"/like"),null)},cancelLike:function(t){var e=t.tweetId;return r["b"].post("/tweets/".concat(e,"/unlike"),null)}}},c193:function(t,e,n){"use strict";n("10ca")},c3e9:function(t,e,n){},c771:function(t,e,n){},c9d0:function(t,e,n){},cb06:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list-group-item"},[n("div",{staticClass:"card-body d-flex align-items-center ml-2"},[t.displayArrow?n("router-link",{attrs:{to:t.arrowDirection}},[n("font-awesome-icon",{staticClass:"icon",attrs:{icon:"arrow-left"}})],1):t._e(),n("div",{staticClass:"topic"},[n("p",[t._v(t._s(t.staticTitle||t.currentRouterName))]),t.user?n("p",{staticClass:"text-muted text-sm"},[t._v(" "+t._s(t.user.tweetsNumber)+" 推文 ")]):t._e()])],1)])},s=[],a=n("5530"),i=(n("b0c0"),n("2f62")),o={props:{user:{type:Object,default:void 0},staticTitle:{type:String,default:""}},data:function(){return{displayArrow:!1,currentRouterName:"",arrowDirection:"/tweets"}},computed:Object(a["a"])({},Object(i["b"])(["currentUser"])),methods:{checkArrowIsDisplay:function(){var t=this.$route.name;"tweets"!==t&&"setting"!==t&&"user-tweets"!==t&&"chat-public"!==t&&"chat-private"!==t&&"admin"!==this.currentUser.role&&(this.displayArrow=!0)},handleCurrentRouterName:function(t){if("setting"===t)this.currentRouterName="帳戶設定";else if("tweets"===t)this.currentRouterName="首頁";else if("tweet"===t)this.currentRouterName="推文";else if("user-tweets"===t||"user-replies"===t||"user-likes"===t||"user-followings"===t||"user-followers"===t)this.currentRouterName=this.user.name;else if("admin-tweets"===t)this.currentRouterName="推文清單";else if("admin-users"===t)this.currentRouterName="使用者清單";else{if("notification"!==t)return"";this.currentRouterName="通知"}}},watch:{user:function(t){var e=this.$route.name;this.handleCurrentRouterName(e),this.arrowDirection="/users/".concat(t.id)}},created:function(){var t=this.$route.name;this.checkArrowIsDisplay(),this.handleCurrentRouterName(t)}},c=o,u=(n("61dc"),n("2877")),l=Object(u["a"])(c,r,s,!1,null,"3e6e8d76",null);e["a"]=l.exports},cb54:function(t,e,n){"use strict";n("d579")},d178:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"navbar"},[r("div",{staticClass:"upper-content"},[r("div",{staticClass:"logo"},[r("router-link",{attrs:{to:"/tweets"}},[r("img",{attrs:{src:n("ad30"),alt:""}})])],1),r("div",{staticClass:"tabs"},[r("router-link",{staticClass:"tab",attrs:{to:"/tweets"}},[r("font-awesome-icon",{attrs:{icon:"home"}}),r("span",[t._v("首頁")])],1),t.notificationIsNoti?r("router-link",{staticClass:"tab noti",attrs:{to:"/notification"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.removeNotificationNoti(e)}}},[r("font-awesome-icon",{attrs:{icon:"bell"}}),r("span",[t._v("通知")])],1):r("router-link",{staticClass:"tab",attrs:{to:"/notification"}},[r("font-awesome-icon",{attrs:{icon:"bell"}}),r("span",[t._v("通知")])],1),t.chatPublicIsNoti?r("router-link",{staticClass:"tab noti",attrs:{to:"/chat/public"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.removeChatPublicNoti(e)}}},[r("font-awesome-icon",{attrs:{icon:"envelope"}}),r("span",[t._v("公開聊天室")])],1):r("router-link",{staticClass:"tab",attrs:{to:"/chat/public"}},[r("font-awesome-icon",{attrs:{icon:"envelope"}}),r("span",[t._v("公開聊天室")])],1),t.chatPrivateIsNoti?r("router-link",{staticClass:"tab noti",attrs:{to:"/chat/all"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.removeChatPrivateNoti(e)}}},[r("font-awesome-icon",{attrs:{icon:"paper-plane"}}),r("span",[t._v("私人訊息")])],1):r("router-link",{staticClass:"tab",attrs:{to:"/chat/all"}},[r("font-awesome-icon",{attrs:{icon:"paper-plane"}}),r("span",[t._v("私人訊息")])],1),r("router-link",{staticClass:"tab",attrs:{to:{name:"user-tweets",params:{id:t.currentUser.id}}}},[r("font-awesome-icon",{attrs:{icon:"user"}}),r("span",[t._v("個人資料")])],1),r("router-link",{staticClass:"tab",attrs:{to:"/setting"}},[r("font-awesome-icon",{attrs:{icon:"cog"}}),r("span",[t._v("設定")])],1)],1),r("button",{staticClass:" btn btn-primary tweeting-button",attrs:{"data-toggle":"modal","data-target":"#tweeting"}},[r("font-awesome-icon",{staticClass:"tweet-icon",attrs:{icon:"feather-alt"}}),r("span",{staticClass:"tweet"},[t._v("推文")])],1)]),r("div",{staticClass:"lower-content"},[r("button",{staticClass:"logout btn",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.logout(e)}}},[r("font-awesome-icon",{attrs:{icon:"door-open"}}),r("span",[t._v("登出")])],1)]),r("Tweeting")],1)},s=[],a=n("5530"),i=(n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"tweeting",staticClass:"modal fade",attrs:{id:"tweeting",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[t._m(0),n("form",{staticClass:"modal-body",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit(e)}}},[n("div",{staticClass:"modal-body-side"},[n("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.currentUser.avatar),alt:""}})]),n("div",{staticClass:"modal-body-content"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],ref:"tweetingArea",staticClass:"tweeting-area",attrs:{type:"textarea",id:"textarea",placeholder:"說些什麼吧？",required:""},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),t._v(" "),n("button",{staticClass:"tweeting-submit btn btn-primary",attrs:{type:"submit",disabled:t.isProcessing}},[t._v(" 推文 ")])])])])])])}),o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],c=n("1da1"),u=(n("96cf"),n("a4d3"),n("e01a"),n("1157")),l=n.n(u),d=n("6783"),f=n("2fa3"),m=n("2708"),p=n("2f62"),b=n("56d7"),h={data:function(){return{description:"",isProcessing:!1}},computed:Object(a["a"])({},Object(p["b"])(["currentUser"])),mixins:[m["a"]],methods:{autoFocus:function(){this.$refs.tweetingArea.focus()},cleanUp:function(){this.description=""},sendNewTweet:function(){var t={type:"tweet",userId:this.currentUser.id,description:this.description};b["socket"].emit("sendNotification",t)},handleSubmit:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,r,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,n=t.description.length,n){e.next=5;break}return f["a"].fire({icon:"warning",title:"請輸入推文內容"}),e.abrupt("return");case 5:if(!(n>140)){e.next=8;break}return f["a"].fire({icon:"warning",title:"推文字數過長，請小於140字"}),e.abrupt("return");case 8:return r={description:t.description},t.isProcessing=!0,e.next=12,d["a"].createTweet({payLoad:r});case 12:if(s=e.sent,a=s.data,"success"===a.status){e.next=16;break}throw new Error(a.message);case 16:t.isProcessing=!1,t.$parent.$emit("after-submit"),t.sendNewTweet(),t.cleanUp(),l()("#tweeting").modal("hide"),e.next=28;break;case 23:e.prev=23,e.t0=e["catch"](0),f["a"].fire({icon:"error",title:"無法新增貼文，請稍後再試"}),t.isProcessing=!1,console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,23]])})))()}},mounted:function(){l()(this.$refs.tweeting).on("shown.bs.modal",this.autoFocus),l()(this.$refs.tweeting).on("hidden.bs.modal",this.cleanUp)}},v=h,g=(n("471e"),n("2877")),w=Object(g["a"])(v,i,o,!1,null,"53c61542",null),k=w.exports,j={data:function(){return{notificationIsNoti:!1,chatPublicIsNoti:!1,chatPrivateIsNoti:!1}},components:{Tweeting:k},computed:Object(a["a"])({},Object(p["b"])(["currentUser"])),methods:{logout:function(){console.log("logout"),b["socket"].emit("sendOffline",{userId:this.currentUser.id}),console.log(this.currentUser.id),this.$store.commit("revokeAuthentication"),this.$router.push("/signin")},removeNotificationNoti:function(){this.notificationIsNoti=!1},removeChatPublicNoti:function(){this.chatPublicIsNoti=!1},removeChatPrivateNoti:function(){this.chatPrivateIsNoti=!1}},created:function(){var t=this;b["socket"].on("receivePublic",(function(e){console.log("navbar receive public: ",e),"chat-public"!==t.$route.name&&(t.chatPublicIsNoti=!0)})),b["socket"].on("receivePrivate",(function(e){console.log("navbar receive private: ",e),"chat-private"!==t.$route.name&&(t.chatPrivateIsNoti=!0)})),b["socket"].on("receiveNotification",(function(e){console.log("navbar receive notification: ",e),"notification"!==t.$route.name&&(t.notificationIsNoti=!0)}))}},C=j,y=(n("f501"),Object(g["a"])(C,r,s,!1,null,"7c8358b4",null));e["a"]=y.exports},d579:function(t,e,n){},dfb0:function(t,e,n){},ed43:function(t,e,n){},f501:function(t,e,n){"use strict";n("bbfd")},ff8c:function(t,e,n){"use strict";n("6f04")}});
//# sourceMappingURL=app.63e628c5.js.map